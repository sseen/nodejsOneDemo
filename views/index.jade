extends layout

block content
  script(src='http://code.jquery.com/jquery-1.9.1.js')
  script(src='javascripts/http.js')
  script(src='javascripts/mui.min.js')
  script.
      mui.init({
          pullRefresh: {
              container: '#pullrefresh',
              down: {
                  callback: pulldownRefresh
              },
              up: {
                  contentrefresh: '正在加载...',
                  callback: pullupRefresh
              }
          }
      });
      /**
       * 下拉刷新具体业务实现
       */
      function pulldownRefresh() {
          setTimeout(function () {
              var table = document.body.querySelector('.mui-table-view');
              var cells = document.body.querySelectorAll('.mui-table-view-cell');
              for (var i = cells.length, len = i + 3; i < len; i++) {
                  var li = document.createElement('li');
                  li.className = 'mui-table-view-cell';
                  li.innerHTML = '<a class="mui-navigate-right">Item ' + (i + 1) + '</a>';
                  //下拉刷新，新纪录插到最前面；
                  table.insertBefore(li, table.firstChild);
              }
              mui('#pullrefresh').pullRefresh().endPulldownToRefresh(); //refresh completed
          }, 1500);
      }
      var count = 0;
      /**
       * 上拉加载具体业务实现
       */
      function pullupRefresh() {
          setTimeout(function () {
              mui('#pullrefresh').pullRefresh().endPullupToRefresh((++count > 2)); //参数为true代表没有更多数据了。
              var table = document.body.querySelector('.mui-table-view');
              var cells = document.body.querySelectorAll('.mui-table-view-cell');
              for (var i = cells.length, len = i + 5; i < len; i++) {
                  var li = document.createElement('li');
                  li.className = 'mui-table-view-cell';
                  li.innerHTML = '<a class="mui-navigate-right">Item ' + (i + 1) + '</a>';
                  table.appendChild(li);
              }
          }, 1500);
      }

  link(rel='stylesheet',type='text/css',href='stylesheets/mui.min.css')

  div#header
    h1= title
    p Welcome to #{title}
    a(href='/users') Users
    button(onclick=('getUrlContent()')) Click

  div#pullrefresh
    div.mui-pull-top-pocket mui-block()
    div#scroll
      div#topFresh
